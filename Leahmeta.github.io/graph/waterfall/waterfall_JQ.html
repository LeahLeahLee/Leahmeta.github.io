<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<title>瀑布流</title>
		<style>
			#main{position:relative;}
			#main .box{padding:5px;float:left;}
			#main .imgWrap{border:1px solid #ccc;box-shadow:0 0 5px #ccc;padding:5px;}
			#main img{width:165px;}
		</style>
		<script src="jquery-1.11.3.js"></script>
	</head>
	<body>
		<div id="main">
			<div class="box">
				<div class="imgWrap">
					<img src="images/0.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/1.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/2.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/3.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/4.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/5.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/6.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/7.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/8.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/9.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/10.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/11.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/12.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/13.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/14.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/15.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/16.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/17.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/18.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/19.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/20.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/21.jpg">
				</div>
			</div>
			<div class="box">
				<div class="imgWrap">
					<img src="images/22.jpg">
				</div>
			</div>							
		</div>
		<script>

			$(window).load(function(){
				waterfall();
			})


			function waterfall(){
				var box=$("#main .box");
				var boxWidth=box.eq(0).innerWidth();
				var cols=Math.floor($(window).width()/boxWidth);
				var height=[];
				box.each(function(key,item){
					if(key<cols){
						height.push($(item).innerHeight());
					}else{
						var index=$.inArray(Math.min.apply(null,height),height);
						var boxitem=$(item);
						boxitem.css({position:"absolute",top:height[index],left:index*boxWidth});
						height[index]+=boxitem.innerHeight();
					}
				})
			}

		</script>
	</body>
</html>